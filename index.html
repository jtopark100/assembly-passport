<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>Router Test v0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',sans-serif;padding:16px">
  <h3>Router Test v0</h3>
  <p>
    #/home홈</a> |
    #/passport여권 보기</a> |
    #/upload사진 업로드</a> |
    #/ranking랭킹</a> |
    #/admin관리자 승인</a>
  </p>


  <div id="view-home">HOME 뷰</div>
  <div id="view-passport" hidden>PASSPORT 뷰</div>
  <div id="view-upload" hidden>UPLOAD 뷰</div>
  <div id="view-ranking" hidden>RANKING 뷰</div>
  <div id="view-admin" hidden>ADMIN 뷰</div>


  <script>
    // 캐시/서비스워커 영향 제거(최초 1회)
    (function(){
      if('serviceWorker' in navigator){
        navigator.serviceWorker.getRegistrations && navigator.serviceWorker.getRegistrations().then(rs=>{
          rs.forEach(r=>{ if(r.scope.includes('/assembly-passport/')) r.unregister(); });
        });
      }
    })();


    const views = ['home','passport','upload','ranking','admin'];
    function show(v){
      views.forEach(id=>{
        const el = document.getElementById('view-'+id);
        if(!el) return;
        el.hidden = (id!==v);
      });
      // 스크롤 올리기
      window.scrollTo({top:0, behavior:'instant'});
    }


    function onHash(){
      const v = (location.hash.replace(/^#\/?/,'')||'home');
      show(views.includes(v)? v : 'home');
    }


    // 앵커+JS 이중 루트
    function nav(v){
      try { location.hash = '#/'+v; } catch(e) { show(v); }
      return false;
    }


    // 터치 보조(모바일)
    document.addEventListener('touchend', e=>{
      const a = e.target.closest('a[href^="#/"]');
      if(!a) return;
      e.preventDefault();
      nav(a.getAttribute('href').replace(/^#\//,''));
    }, {passive:false});


    window.addEventListener('hashchange', onHash);
    window.addEventListener('load', onHash);
  </script>
  <!-- MARK R0 -->
</body>
 

</html>